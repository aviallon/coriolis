<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Contents December 2023 BUG | Bad Topology in NetBuilderHV::_do_xG_1M1() CHANGE | Reorganization of the size detection of RoutingPad NEW | Implementation of Pin Rectilinear Support NEW | Support...">
        <meta name="keywords" content="">
        <link rel="icon" href="../favicon.ico">

        <title>Coriolis Technical Log - Coriolis VLSI CAD Tools</title>

        <!-- Stylesheets -->
        <link href="../theme/css/bootstrap.css" rel="stylesheet">
        <link href="../theme/css/fonts.css"     rel="stylesheet">
        <link href="../theme/css/nest.css"      rel="stylesheet">
        <link href="../theme/css/pygment.css"   rel="stylesheet">
        <link href="../theme/css/coriolis.css"  rel="stylesheet">
        <!-- /Stylesheets -->

        <script src="../theme/js/jquery.min.js"></script>
        <script src="../theme/js/bootstrap.min.js"></script>

        <!-- RSS Feeds -->
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->



    </head>

    <body>
      <!-- Header -->
    <div class="header-container" style="background: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url('../images/common/layout-motif-faded-4.png'); background-position: center; ">


      <!--
      <div class="container">
        <nav class="navbar navbar-default">
          <div class="container-fluid">
            <div class="navbar-header">
              <a class="navbar-brand" href="../"><img class="mr20" src="../images/common/Coriolis-logo-white-4-small.png" alt="logo">Coriolis VLSI CAD Tools</a>
            </div>
            <ul class="nav navbar-nav">
                   <li><a href="../pages/github.html">Git</a></li>
                   <li><a href="../pages/documentation.html">Documentation</a></li>
              <li class="dropdown">
                <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                  <span class="caret"></span>Topics
                </button>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item " href="../pages/homepage.html">Coriolis <span class="sc">vlsi</span> Backend Tools</a></li>
                  <li><a class="dropdown-item " href="../pages/symbolic-layout.html">Symbolic Layout</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </nav>
      </div> <!-- navbar container -->
      -->

      <!-- Static navbar -->
      <div class="container">
        <div class="header-nav">
          <div class="header-logo">
            <a class="pull-left" href="../"><img class="mr20" src="../images/common/Coriolis-logo-white-4-small.png" alt="logo">Coriolis VLSI CAD Tools</a>
          </div>
          <div class="nav pull-right">
                <a href="../pages/github.html">Git</a>
                <a href="../pages/documentation.html">Documentation</a>
          </div>
          <div class="nav pull-right">
            <div class="dropdown">
              <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                <span class="caret"></span>Topics
              </button>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item " href="../pages/homepage.html">Coriolis <span class="sc">vlsi</span> Backend Tools</a></li>
                <li><a class="dropdown-item " href="../pages/symbolic-layout.html">Symbolic Layout</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <!-- /Static navbar -->

        <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <a href="https://www.lip6.fr/"><img class="mr20" height="60px" src="../images/common/LogoLIP6Blanc.png" alt="LIP6"></a>
                      <a href="https://www.sorbonne-universite.fr/"><img class="mr20" height="60px" src="../images/common/logo-SU-blanc-700px.png" alt="Sorbonne Universite"></a>
                      <a href="https://www.cnrs.fr/"><img class="mr20" height="60px" src="../images/common/LOGO-cnrs-white-large.png" alt="CNRS"></a>
                      <h1 class="header-title text-uppercase">Coriolis Technical Log</h1>
                      <div class="header-underline"></div>
                  </div>
              </div>
        </div>
    </div>
        <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <!-- -*- Mode: rst -*- -->
<!-- -*- Mode: rst; explicit-buffer-name: "definition.rst<documentation/etc>" -*- -->
<!-- HTML/LaTeX backends mixed macros. -->
<!-- Acronyms & names. -->
<!-- URLs -->
<!-- Standard CAO/VLSI Concepts. -->
<!-- Alliance & MBK Concepts -->
<!-- Hurricane Concepts. -->
<!-- Link to Hurricane doc (Doxygen) -->
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#december-2023" id="toc-entry-1">December 2023</a><ul>
<li><a class="reference internal" href="#bug-bad-topology-in-netbuilderhv-do-xg-1m1" id="toc-entry-2"><strong>BUG</strong> | Bad Topology in <tt class="docutils literal"><span class="pre">NetBuilderHV::_do_xG_1M1()</span></tt></a></li>
<li><a class="reference internal" href="#change-reorganization-of-the-size-detection-of-routingpad" id="toc-entry-3"><strong>CHANGE</strong> | Reorganization of the size detection of RoutingPad</a></li>
<li><a class="reference internal" href="#new-implementation-of-pin-rectilinear-support" id="toc-entry-4"><strong>NEW</strong> | Implementation of Pin Rectilinear Support</a></li>
<li><a class="reference internal" href="#new-support-for-offgrid-m1-vh-topologies-wip-1" id="toc-entry-5"><strong>NEW</strong> | Support for offgrid M1 &amp; VH topologies (WIP 1)</a></li>
<li><a class="reference internal" href="#new-display-the-ripup-ratio-in-katana-statistics" id="toc-entry-6"><strong>NEW</strong> | Display the &quot;ripup ratio&quot; in Katana::Statistics</a></li>
<li><a class="reference internal" href="#new-support-saving-restoring-positions-and-settings-of-graphic-windows" id="toc-entry-7"><strong>NEW</strong> | Support saving &amp; restoring positions and settings of graphic windows</a></li>
</ul>
</li>
</ul>
</div>
<!-- -*- Mode: rst -*- -->
<div class="section" id="december-2023">
<h2><a class="toc-backref" href="#toc-entry-1">December 2023</a></h2>
<div class="section" id="bug-bad-topology-in-netbuilderhv-do-xg-1m1">
<h3><a class="toc-backref" href="#toc-entry-2"><strong>BUG</strong> | Bad Topology in <tt class="docutils literal"><span class="pre">NetBuilderHV::_do_xG_1M1()</span></tt></a></h3>
<p>In case of three globals (one <tt class="docutils literal">M1</tt> terminal) and <em>no</em> south global,
the generated topology was wrong. We were accessing the terminal directly
with a vertical segment. It was creating a layer gap between <em>that</em>
vertical, which is <tt class="docutils literal">M3</tt> and and terminal in <tt class="docutils literal">M1</tt>. This is also
too rigid a configuration.</p>
<p>Fix: add an horizontal, in <tt class="docutils literal">M2</tt>, to access the terminal.</p>
<p>Occured on <tt class="docutils literal"><span class="pre">benchs/RISC-V/Minerva/sky130_c4m/</span></tt>.</p>
<img alt="Faulty _do_xG_1M3 (no South) configuration." class="align-center" src="../images/notes/Katana-Debug_3.png" style="width: 60%;" />
</div>
<div class="section" id="change-reorganization-of-the-size-detection-of-routingpad">
<h3><a class="toc-backref" href="#toc-entry-3"><strong>CHANGE</strong> | Reorganization of the size detection of RoutingPad</a></h3>
<p>Instead of detecting the size characteristics of a <a class="reference external" href="../doc/hurricane/classHurricane_1_1RoutingPad.html">RoutingPad</a> at a late
stage when calling <tt class="docutils literal"><span class="pre">NetBuilder::_doRp_Access()</span></tt>, do it once when first
loading the net in <tt class="docutils literal"><span class="pre">Dijkstra::load()</span></tt> with <tt class="docutils literal"><span class="pre">Configuration::selectRpcomponent()</span></tt>.</p>
<p>Add a new flag attribute on <a class="reference external" href="../doc/hurricane/classHurricane_1_1RoutingPad.html">RoutingPad</a> in order to store various
additionnal informations. Currently, the size characteristics.</p>
<p>Add an <tt class="docutils literal">M1Offgrid</tt> flags for the terminal characteristics set.</p>
<p>Move <tt class="docutils literal">getPositions()</tt> and <tt class="docutils literal">checkRoutingPadSize()</tt> from <tt class="docutils literal">NetBuilder</tt> to
<tt class="docutils literal"><span class="pre">Anabatic::Configuration()</span></tt>.</p>
<p>In <tt class="docutils literal"><span class="pre">Anabatic::Configuration</span></tt>, add support for the <tt class="docutils literal">M1Offgrid</tt> options,
that allows fully offgrid terminals.</p>
<p>The <tt class="docutils literal"><span class="pre">Anabatic::Configuration::checkRoutingpadSize()</span></tt> now store the
characteristics of the terminal (<tt class="docutils literal">HSmall</tt>, <tt class="docutils literal">VSmall</tt>, ...) directly in
the flags of the <tt class="docutils literal">RoutingPad</tt>.</p>
<p>For the whole function stack, work directly on <a class="reference external" href="../doc/hurricane/classHurricane_1_1RoutingPad.html">RoutingPad</a> instead of
<tt class="docutils literal">Component*</tt> :</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">NetBuilder::_doRp_StairCaseH()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">NetBuilder::_doRp_StairCaseV()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">NetBuilderHV::_doRp_Access()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">NetBuilderHV::_doRp_AutoContacts()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">NetBuilderHybridHV::_doRp_Access()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">NetBuilderHybridHV::_doRp_AutoContacts()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">NetBuilderM2::_doRp_Access()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">NetBuilderM2::_doRp_AutoContacts()</span></tt></li>
</ul>
</div>
<div class="section" id="new-implementation-of-pin-rectilinear-support">
<h3><a class="toc-backref" href="#toc-entry-4"><strong>NEW</strong> | Implementation of Pin Rectilinear Support</a></h3>
<p>Add a <tt class="docutils literal">PinRectilinearFilter</tt> to the <tt class="docutils literal">LefImport</tt> parser in order to select
on which kind of biggest rectangle extracted from the <tt class="docutils literal">Rectilinear</tt> we want
to create the <tt class="docutils literal">Vertical</tt> or <tt class="docutils literal">Horizontal</tt> <em>only</em> external component.
We can choose betwen the <em>tallest</em>, <em>widest</em> or <em>largest</em> (area).
There is also a minimum size filtering (to prune too small rectangle
from the start).</p>
<p>Make use of the new feature in <tt class="docutils literal">gf180mcu/mcu9t5v0.py</tt>.</p>
</div>
<div class="section" id="new-support-for-offgrid-m1-vh-topologies-wip-1">
<h3><a class="toc-backref" href="#toc-entry-5"><strong>NEW</strong> | Support for offgrid M1 &amp; VH topologies (WIP 1)</a></h3>
<div class="section" id="add-a-flag-attribute-in-routingpad">
<h4>1. Add a flag attribute in <a class="reference external" href="../doc/hurricane/classHurricane_1_1RoutingPad.html">RoutingPad</a></h4>
<p>To avoid re-computing informations about the <a class="reference external" href="../doc/hurricane/classHurricane_1_1RoutingPad.html">RoutingPad</a>, namely it's size
characteristics (h-small, v-small, punctual, offgrid), add a <tt class="docutils literal">flag</tt> attribute
in order to store those informations. They are computed in
<tt class="docutils literal"><span class="pre">Anabatic::Configuration::selectRpComponent()</span></tt>.</p>
</div>
<div class="section" id="implement-horizontal-dragging-autocontactterminal-updategeometry">
<h4>2. Implement horizontal dragging <tt class="docutils literal"><span class="pre">AutoContactTerminal::updateGeometry()</span></tt></h4>
<p>Dragging can occurs when an <tt class="docutils literal">AutoContactTerminal</tt> is anchored on an
horizontal <a class="reference external" href="../doc/hurricane/classHurricane_1_1RoutingPad.html">RoutingPad</a> <strong>and</strong> the opposite of the connecting segment
is also horizontal. In that case, the connecting segment, which is
<em>perpandicular</em> can be <em>dragged</em> over the <a class="reference external" href="../doc/hurricane/classHurricane_1_1RoutingPad.html">RoutingPad</a> as to minimize
the length of the opposite horizontal.</p>
<p>This feature was until now, only implemenred for verticals.</p>
<img alt="Vertical dragging configuration." class="align-center" src="../images/notes/Katana-Debug_7.png" style="width: 60%;" />
</div>
<div class="section" id="clarify-sourceposition-targetposition-on-autosegments">
<h4>3. Clarify sourcePosition &amp; targetPosition on AutoSegments</h4>
<p>The <tt class="docutils literal">_sourcePosition</tt> and <tt class="docutils literal">_targetPosition</tt> of <tt class="docutils literal">AutoHorizontal</tt> or
<tt class="docutils literal">AutoVertical</tt> have slighty different meanings whether the segment is
in preferred routing direction or not.</p>
<ol class="upperalpha simple">
<li><strong>In preferred routing direction</strong>  (fig. a) the position extend from
the segment for <em>half</em> the minimum spacing (plus half the size of the
starting or ending VIA). With neighboring segments extentions
computed the same, we ensure that the minimal spacing is always kept.
The complex work of computing the value of the extension of the end
cap of a segment is done by <tt class="docutils literal"><span class="pre">AutoSegment::getExtensionCap()</span></tt>.</li>
<li><strong>In perpandicular routing direction</strong> (fig. b) the <tt class="docutils literal">_sourcePosition</tt>
to <tt class="docutils literal">_targetPosition</tt> interval should cross all the perpandicular
track axis that it has a footprint on. As it may be misaligned and
likely to impinge on the leftmost or rightmost one. In that case,
we must extend by the <em>minimal spacing</em> (not it's half).</li>
</ol>
<img alt="Preferred &amp; non-preferred track footprint." class="align-center" src="../images/notes/Katana-Debug_9.png" style="width: 60%;" />
<p>The figure below is a simplificated description on how <tt class="docutils literal"><span class="pre">AutoSegment::getExtensionCap()</span></tt>
compute the extension from the <tt class="docutils literal">sourceU</tt> coordinate. <tt class="docutils literal">sourceU</tt> being the
starting or ending coordinate of segment, usually the axis of the perpandicular
it is connected to.</p>
<img alt="Preferred &amp; non-preferred track footprint." class="align-center" src="../images/notes/Katana-Debug_6.png" style="width: 60%;" />
</div>
<div class="section" id="write-topology-for-netbuildervh-do-2g-1m1">
<h4>4. Write topology for NetBuilderVH::_do_2G_1M1()</h4>
<img alt="topology of NetBuilderVH::_do_2G_1M1()." class="align-center" src="../images/notes/Katana-Debug_5.png" style="width: 60%;" />
</div>
<div class="section" id="allow-selection-of-hv-or-vh-topologies-for-gf180mcu">
<h4>4. Allow selection of HV or VH topologies for GF180MCU</h4>
<p>In order to ease testing whithout constantly changing the configuration
file, provide a boolean in <tt class="docutils literal">technos.setupGF180MCU_GF()</tt> to select it.</p>
<p>In the <tt class="docutils literal">dodo.py</tt>, add:</p>
<div class="highlight"><pre><span></span><span class="n">setupGF180MCU_GF</span><span class="p">(</span> <span class="n">checkToolkit</span><span class="o">=</span><span class="s1">&#39;../../..&#39;</span><span class="p">,</span> <span class="n">pdkTop</span><span class="o">=</span><span class="s1">&#39;../../../../gf180mcu-pdk&#39;</span><span class="p">,</span> <span class="n">useHV</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="new-display-the-ripup-ratio-in-katana-statistics">
<h3><a class="toc-backref" href="#toc-entry-6"><strong>NEW</strong> | Display the &quot;ripup ratio&quot; in Katana::Statistics</a></h3>
<p>This ratio is an attempt at characterizing the <em>hardness</em> of a design
(very elusive concept). It is crudely done for now, as it is just a
ratio between the initial number of events (which is equal to the
number of <span class="cb">TrackElements</span> to place). It do not take into account the
dogleg creation process that will introduce more primary events
as the net topologie are slackened.</p>
</div>
<div class="section" id="new-support-saving-restoring-positions-and-settings-of-graphic-windows">
<h3><a class="toc-backref" href="#toc-entry-7"><strong>NEW</strong> | Support saving &amp; restoring positions and settings of graphic windows</a></h3>
<p>The positions of the windows and <em>some</em> of the settings of the controller
can be saved and restored. The saving does not occurs at the closing of
the application. You have to take a <em>snapshot</em> of the state using the
<tt class="docutils literal">File <span class="pre">-&gt;</span> Save settings</tt> menu. This allow to restart the application
in an initial state of your choosing and not at point you left it the
last time it was run.</p>
<p>Widgets supporting the saving of their configuration gets two more methods:</p>
<pre class="code C++ literal-block">
<span class="n">MyWidget</span><span class="o">::</span><span class="n">saveQtSettings</span><span class="p">();</span><span class="w">
</span><span class="n">MyWidget</span><span class="o">::</span><span class="n">readQtSettings</span><span class="p">();</span>
</pre>
<p>Currently we are saving:</p>
<ul class="simple">
<li><tt class="docutils literal">UnicornGui</tt></li>
<li><tt class="docutils literal">CellViewer</tt></li>
<li><tt class="docutils literal">LibraryManager</tt></li>
<li><tt class="docutils literal">ControllerWidget</tt> and some of it's tabs.</li>
<li><tt class="docutils literal">Breakpoint</tt></li>
</ul>
</div>
</div>

    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Map</div>
                        <ul class="list-unstyled">
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-2">
                        <div class="footer-title">Social</div>
                        <ul class="list-unstyled">
                            <li><a href="element://vector/webapp/#/room/%23coriolis%3Amatrix.org?via=matrix.or" target="_blank">Matrix</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Links</div>
                        <ul class="list-unstyled">
                            <li><a href="https://coriolis.lip6.fr/" target="_blank">Alliance/Coriolis</a></li>
                            <li><a href="https://largo.lip6.fr/" target="_blank">CIAN Team Website</a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-4">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
			    <small><em><span class="sc">NEST</span> theme by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>Copyright © 2020-2020 Sorbonne Universite</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>